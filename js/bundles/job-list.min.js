!function(){const c="form-search",i="job-list",l="pagination-wrap",s="On-site Work",d=(e,t,r)=>r.indexOf(e)===t&&!!e,u=(e={})=>{var t,r=new URL(window.location.href);for(t in e)e[t]?r.searchParams.set(t,e[t]):r.searchParams.delete(t);window.history.pushState({},"",r)},p=e=>{const t=e.querySelector("#id_search"),r=e.querySelector("#location"),a=e.querySelector("#worktype"),n=e.querySelector("#page"),o=e.querySelector("#btn-reset"),c=()=>({q:t.value,location:r.value,typeWork:a.value,page:n.value});const i=()=>{var e=c();u(e),s&&s(e)},l=(t.addEventListener("input",i),r.addEventListener("change",i),a.addEventListener("change",i),o?.addEventListener("click",()=>{[t,r,a].forEach(e=>e.value=""),i()}),(r,e)=>{e.forEach(e=>{var t=document.createElement("option");t.text=t.value=e,r.appendChild(t)})});let s=null;return changePage=null,n.value=1,{queryParams:c,setValueBySearchParams:()=>{var e=(()=>{var e,t={};for(e of new URLSearchParams(window.location.search))e[1]&&(t[e[0]]=e[1]);return t})();"q"in e&&(t.value=e.q),"location"in e&&(r.value=e.location),"typeWork"in e&&(a.value=e.typeWork),"page"in e&&(n.value=e.page),i()},setLocationOptions:e=>l(r,e),setTypeWorkOptions:e=>l(a,e),setPage:e=>{n.value=e;var t=c();u(t),changePage&&changePage(e)},currentPage:()=>parseInt(n.value),change:e=>s=e,changePage:e=>changePage=e,emit:()=>!!changePage&&changePage(parseInt(n.value))}},h=(n,r)=>{let o=[];const a=r.querySelector("[data-job-card]").cloneNode(!0),e=r.querySelector(".filter_empty"),c=(e?.remove(),e=>{var t=a.cloneNode(!0),r=(t.querySelector("[data-card-title]").innerText=e?.internalName,t.querySelector("[data-card-is-job]").innerText=e?.remoteWorkOption?.name||s,t.querySelector("[data-card-local]").innerText=e?.place?.address?.city,t.querySelector("[data-card-country]").innerText=e?.place?.country?.name,t.querySelector("[data-card-date]").innerText=(e=>{e=new Date(e);return e.getDate().toString().padStart(2,"0")+`/${(e.getMonth()+1).toString().padStart(2,"0")}/`+e.getFullYear()})(e.creationDate),t.querySelector("[data-card-btn-detail]"));return r.href="job-description?job="+e.id,r.title=e?.internalName,t});const i=()=>{r.innerHTML="",r.append(e)};return{fetchAPI:async()=>{try{r="https://api.cvwarehouse.com/cvwJobsApiNearU/f1999e48-cee5-4f55-984e-1f26a6f0cf55/Job/own_website/JSON1_16",a={};var e=await new Promise((e,t)=>{$.get({url:r,dataType:"json",data:a,success:e}).fail(t)}),t=(o=e.sort((e,t)=>new Date(t.publicationDate)-new Date(e.publicationDate))).map(e=>e?.remoteWorkOption?.name)?.filter(d)?.reverse();o.some(e=>null===e?.remoteWorkOption)&&t.push(s),n.setLocationOptions(o.map(e=>e?.place?.address?.city)?.filter(d)?.reverse()),n.setTypeWorkOptions(t)}catch(e){i()}var r,a},jobs:()=>[...o],search:t=>o.filter(e=>!t.location||!!t.location&&e?.place?.address?.city===t.location).filter(e=>!t.typeWork||!!t.typeWork&&e?.remoteWorkOption?.name===t.typeWork||t.typeWork===s&&!e?.remoteWorkOption).filter(e=>!t.q||!!t.q&&[e?.place?.country?.name,e?.remoteWorkOption?.name,e?.name?.value,e?.description?.value].some(e=>e?.toLowerCase()?.includes(t.q?.toLowerCase()))),render:(e,t)=>{r.innerHTML="",e.forEach(e=>r.append(c(e))),document.getElementById("result-label").innerText=t+" "},showNotFound:i}},m=({rootElem:e,perPage:t,formSearch:a})=>{const r=e.querySelector("#btn-prev"),n=e.querySelector("#btn-next"),c=[];let i=[];const o="filter_pagination-number";let l=[];const s=()=>{c.forEach(e=>e.elem.removeEventListener("click",e.handler)),e.querySelectorAll("."+o).forEach(e=>e.remove())},d=t=>{var e=document.createElement("button"),r=t<0?"...":t,r=(e.title=r,e.type="button",e.classList.add(o),a.currentPage()===t&&e.classList.add("filter_pagination-number--active"),e.innerHTML=`<div>${r}</div>`,()=>{let e=t;-1===t?e=i[i.indexOf(t)-1]+1:-2===t&&(e=i[i.indexOf(t)+1]-1),h(e)});return e.addEventListener("click",r),{elem:e,handler:r}},u=()=>Math.ceil(l.length/t),p=a=>{var e=u();const n=Array.from({length:e}).map((e,t)=>t+1);s();let o=r;(i=(()=>{let e=[...n];const t=a+2,r=a-2;return 2<(e=e.filter(e=>e>=r&&e<=t)).at(0)&&e.unshift(1,-2),e.at(-1)<n.length&&e.push(-1,n.length),e})()).forEach(e=>{var t,r,e=d(e);c.push(e),t=o,r=e.elem,t.parentNode.insertBefore(r,t.nextSibling),o=e.elem})},h=e=>{a.setPage(e),p(e)};r.addEventListener("click",()=>{var e=a.currentPage()-1;0<e&&h(e)}),n.addEventListener("click",()=>{var e=a.currentPage()+1;e<=u()&&h(e)});return{renderBtns:p,perPage:t,paginate:e=>{e=(e-1)*t;return l.slice(e,e+t)},getJobs:()=>l,setJobs:e=>l=e}};window.addEventListener("DOMContentLoaded",()=>{(async()=>{var e=document.querySelector("#"+c),t=document.querySelector("#"+i),r=document.querySelector("#"+l);const a=p(e),n=h(a,t);try{await n.fetchAPI();const o=m({rootElem:r,formSearch:a,perPage:44444});a.setValueBySearchParams(),a.changePage(e=>{var t=n.search(a.queryParams());o.setJobs(t),o.renderBtns(e),n.render(o.paginate(e),o.getJobs()?.length)}),a.change(()=>a.setPage(1)),a.emit()}catch(e){n.showNotFound()}})()})}();